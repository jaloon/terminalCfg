(function(a,b){if(typeof define==="function"&&define.amd){define(["$"],b)}else{if(typeof exports==="object"){module.exports=b()}else{a.Paging=b(window.Zepto||window.jQuery||$)}}})(this,function(b){b.fn.Paging=function(d){var c=[];b(this).each(function(){var e=b.extend({target:b(this)},d);var f=new a();f.init(e);c.push(f)});return c};function a(){var c=Math.random().toString().replace(".","");this.id="Paging_"+c}a.prototype={init:function(c){this.settings=b.extend({callback:null,pagesize:10,current:1,prevTpl:"上一页",nextTpl:"下一页",firstTpl:"首页",lastTpl:"末页",ellipseTpl:"...",toolbar:false,hash:true,pageSizeList:[5,10,15,20]},c);this.target=b(this.settings.target);this.container=b('<div id="'+this.id+'" class="ui-paging-container"/>');this.target.html(this.container);this.render(this.settings);this.format();this.bindEvent()},render:function(c){this.count=c.count||this.settings.count;this.pagesize=c.pagesize||this.settings.pagesize;this.current=c.current||this.settings.current;this.pagecount=Math.ceil(this.count/this.pagesize);this.format()},bindEvent:function(){var c=this;this.container.on("click","li.js-page-action,li.ui-pager",function(d){if(b(this).hasClass("ui-pager-disabled")||b(this).hasClass("focus")){return false}if(b(this).hasClass("js-page-action")){if(b(this).hasClass("js-page-first")){c.current=1}if(b(this).hasClass("js-page-prev")){c.current=Math.max(1,c.current-1)}if(b(this).hasClass("js-page-next")){c.current=Math.min(c.pagecount,c.current+1)}if(b(this).hasClass("js-page-last")){c.current=c.pagecount}}else{if(b(this).data("page")){c.current=parseInt(b(this).data("page"))}}c.go()})},getQuery:function(d,l,k){var f=new RegExp("(^|&|#)"+d+"=([^&]*)(&|$|#)","i");k=k||window;var e=k.location.href;var m,j,h="";if(l=="#"){m=e.split("#")}else{m=e.split("?")}if(m.length==1){j=""}else{j=m[1]}if(j!=""){gg=j.split(/&|#/);var c=gg.length;str=arguments[0]+"=";for(i=0;i<c;i++){if(gg[i].indexOf(str)==0){h=gg[i].replace(str,"");break}}}return decodeURI(h)},setHash:function(e){var f="";e=b.extend(this.getHash(),e);var c=[];for(var d in e){if(e[d]!=""){c.push(d+"="+encodeURIComponent(e[d]))}}f+=c.join("&");location.hash=f;return this},getHash:function(f){if(typeof f==="string"){return this.getQuery(f,"#")}else{var j={};var h=location.hash;if(h.length>0){h=h.substr(1);var e=h.split("&");for(var g=0,d=e.length;g<d;g++){var c=e[g].split("=");if(c.length>0){j[c[0]]=decodeURI(c[1])||""}}}return j}},go:function(c){var d=this;this.current=c||this.current;this.current=Math.max(1,d.current);this.current=Math.min(this.current,d.pagecount);this.format();if(this.settings.hash){this.setHash({page:this.current})}this.settings.callback&&this.settings.callback(this.current,this.pagesize,this.pagecount)},changePagesize:function(c){this.render({pagesize:c})},format:function(){var d="<ul>";d+='<li class="js-page-first js-page-action ui-pager" >'+this.settings.firstTpl+"</li>";d+='<li class="js-page-prev js-page-action ui-pager">'+this.settings.prevTpl+"</li>";if(this.pagecount>6){d+='<li data-page="1" class="ui-pager">1</li>';if(this.current<=2){d+='<li data-page="2" class="ui-pager">2</li>';d+='<li data-page="3" class="ui-pager">3</li>';d+='<li class="ui-paging-ellipse">'+this.settings.ellipseTpl+"</li>"}else{if(this.current>2&&this.current<=this.pagecount-2){d+="<li>"+this.settings.ellipseTpl+"</li>";d+='<li data-page="'+(this.current-1)+'" class="ui-pager">'+(this.current-1)+"</li>";d+='<li data-page="'+this.current+'" class="ui-pager">'+this.current+"</li>";d+='<li data-page="'+(this.current+1)+'" class="ui-pager">'+(this.current+1)+"</li>";d+='<li class="ui-paging-ellipse" class="ui-pager">'+this.settings.ellipseTpl+"</li>"}else{d+='<li class="ui-paging-ellipse" >'+this.settings.ellipseTpl+"</li>";for(var c=this.pagecount-2;c<this.pagecount;c++){d+='<li data-page="'+c+'" class="ui-pager">'+c+"</li>"}}}d+='<li data-page="'+this.pagecount+'" class="ui-pager">'+this.pagecount+"</li>"}else{for(var c=1;c<=this.pagecount;c++){d+='<li data-page="'+c+'" class="ui-pager">'+c+"</li>"}}d+='<li class="js-page-next js-page-action ui-pager">'+this.settings.nextTpl+"</li>";d+='<li class="js-page-last js-page-action ui-pager">'+this.settings.lastTpl+"</li>";d+="</ul>";this.container.html(d);if(this.current==1){b(".js-page-prev",this.container).addClass("ui-pager-disabled");b(".js-page-first",this.container).addClass("ui-pager-disabled")}if(this.current==this.pagecount){b(".js-page-next",this.container).addClass("ui-pager-disabled");b(".js-page-last",this.container).addClass("ui-pager-disabled")}this.container.find('li[data-page="'+this.current+'"]').addClass("focus").siblings().removeClass("focus");if(this.settings.toolbar){this.bindToolbar()}},bindToolbar:function(){var h=this;var e=b('<li class="ui-paging-toolbar"><select class="ui-select-pagesize"></select><input type="text" class="ui-paging-count"/><a href="javascript:void(0)">跳转</a></li>');var f=b(".ui-select-pagesize",e);var g="";for(var d=0,c=this.settings.pageSizeList.length;d<c;d++){g+='<option value="'+this.settings.pageSizeList[d]+'">'+this.settings.pageSizeList[d]+"条/页</option>"}f.html(g);f.val(this.pagesize);b("input",e).val(this.current);b("input",e).click(function(){b(this).select()}).keydown(function(k){if(k.keyCode==13){var j=parseInt(b(this).val())||1;h.go(j)}});b("a",e).click(function(){var j=parseInt(b(this).prev().val())||1;h.go(j)});f.change(function(){h.changePagesize(b(this).val())});this.container.children("ul").append(e)}};return a});